---
title: "Video Game Sales"
author: "Team Octopi"
date: "12/13/19"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r load-packages, message=FALSE}
library(tidyverse)
library(broom)
library(knitr)
library(modelr)
library(infer)
library(dplyr)
```

```{r load-data, message=FALSE, warning=FALSE}
set.seed(24601)
vgsales <- read_csv("/cloud/project/data/vgsales.csv")
vgsales_top_100 <- vgsales %>%
  head(100)
```

### Introduction

What are the criteria for a successful video game? In this project, we will use data analysis to determine which qualities are likely to improve the success of a video game, which is based on the games ranking. The videogame rankings in this dataset were determined by sales. 

The dataset came from vgchartz.com, an industry research firm that publishes worldwide game hardware and software sales, as well as over 40,000 game titles. The data was generated by a scrape of this website, selecting 11 variables and collecting data for video game sales. There are 16,598 records in the dataset, with each case representing a different video game. We have narrowed the data to represent only the top 100 video games, as well as taken a random sample of 100 video games to represent our "population" in hypothesis testing, bootstrap simulations, etc.

The variables of the dataset are listed below: 

Rank - Ranking of overall sales

Name - The game's name

Platform - Platform on which the game was released (i.e. PC,PS4, etc.)

Year - Year of the game's release

Genre - Genre of the game

Publisher - Publisher of the game

NA_Sales - Sales in North America (in millions)

EU_Sales - Sales in Europe (in millions)

JP_Sales - Sales in Japan (in millions)

Other_Sales - Sales in the rest of the world (in millions)

Global_Sales - Total worldwide sales.

We are specifically interested in what factors affect the sales of video games. By answering the questions below, we hope to find some answers.

1) Do video games from certain publishers or on certain platforms tend to have higher sales in said publisher/platform's region of origin?

We predict that the publisher's place of origin will have higher video game sales in that particular region, since that publisher may be more recognized from the region of origin. We do not believe that the platform's region of origin will increase the sales in the origin region, because it is unlikely most people know where the platforms are produced, or care. We think this is really interesting because it will tell us if the different video game users in different countries have preferences for their own publishers and platforms. 

2) Gamers have a wide range of preferences in terms of genres. Additionally, even with modern games debuting every year, many gamers choose to purchase retro games instead. Are game sales in particular regions of the world affected by genre and/or when the game was originally released?

We predict that there will be more games sold in the more recent years, but we are interested to see if the video games sold in the 20th century are comparable to the 21st century, since video games were also very popular in the late 1900's. We also predict that there will be higher sales of different genres around the world, because of cultural differences. 

### Exploratory Analysis

Below are the preliminary analyses of variables and bivariate/multivariate relationships.

```{r publisher}
vgsales %>%
  group_by(Publisher) %>%
  summarise(count = n()) %>%
  mutate(freq = count / sum(count)) %>%
  arrange(desc(freq)) %>%
  head(10)
```

From the results above, EA has published the most video games from this data set, with Activision and Ubisoft following. However, each publisher accounts for a small amount of the total video game market in the data set, but filtering for the top 100 may show the proportion of publishers for the top video games.

```{r publisher-top-100}
vgsales_top_100 %>%
  group_by(Publisher) %>%
  summarise(count = n()) %>%
  mutate(freq = count / sum(count)) %>%
  arrange(desc(freq))

vgsales_top_100 %>%
  group_by(Publisher) %>%
  summarise(count = n()) %>%
  ggplot(aes(x = Publisher, y = count)) +
  geom_col() +
  labs(title = "Video Games by Publisher",
       subtitle = "Out of Top 100",
       y = "Number of Videogames") +
  coord_flip() +
  theme_light()
```

Figure 1

The results above show the most popular publishers among the top 100 video games in terms of global sales. As shown, Nintendo by far has the most video games in the top 100, with Activision coming in second. This shows that although Nintendo may not have made as many video games as other publishers, they have the most popular video games.

```{r publisher-sales}
vgsales %>%
  filter(Year <= 2019) %>%
  group_by(Publisher) %>%
  summarize(Sales = sum(Global_Sales, na.rm = TRUE)) %>%
  arrange(desc(Sales)) %>%
  head(10)

vgsales_top_100 %>%
  drop_na(Publisher) %>%
  group_by(Publisher) %>%
  mutate(Sales = sum(Global_Sales, na.rm = TRUE)) %>%
  ggplot(aes(x = Publisher, y = Sales)) +
  geom_col() +
  labs(title = "Video Game Sales by Publisher",
       subtitle = "Out of Top 100",
       y = "Total Global Sales (in Millions)") +
  coord_flip() +
  theme_light()
```

Figure 2

Previously, we analyzed publishers based on the amount of video games they have produced. Now, upon analysis of the total sales for each publisher, Nintendo is clearly the leader, followed by EA and Activision. The graph above displays total sales by publisher out of the top 100 video games, and Nintendo is clearly the leader, followed by Activision and Take-Two. EA had the second highest total sales out of the whole data set but 6th out of the top 100, indicating that the high amounts of video games produced drove total sales up even sales for their video games that made the top 100 remained relatively small. 

```{r platform-top-100}
vgsales_top_100 %>%
  group_by(Platform) %>%
  summarise(count = n()) %>%
  mutate(freq = count / sum(count)) %>%
  arrange(desc(freq))

vgsales_top_100 %>%
  group_by(Platform) %>%
  summarise(count = n()) %>%
  ggplot(aes(x = Platform, y = count)) +
  geom_col() +
  labs(title = "Video Games by Platform",
       subtitle = "Out of Top 100",
       y = "Number of Videogames") +
  coord_flip() +
  theme_light()
```

Figure 3

Looking at the platforms that the video games are released on, XBOX 360, Wii, and DS have the most games out of the top 100 video games. The graph above shows that the top video games were published on a variety of platforms, not just two or three. 

```{r platform-sales}
vgsales %>%
  filter(Year <= 2019) %>%
  group_by(Platform) %>%
  summarize(Sales = sum(Global_Sales, na.rm = TRUE)) %>%
  arrange(desc(Sales))

vgsales_top_100 %>%
  drop_na(Platform) %>%
  group_by(Platform) %>%
  mutate(Sales = sum(Global_Sales, na.rm = TRUE)) %>%
  ggplot(aes(x = Platform, y = Sales)) +
  geom_col() +
  labs(title = "Video Game Sales by Platform",
       subtitle = "Out of Top 100",
       y = "Total Global Sales (in Millions)") +
  coord_flip() +
  theme_light()
```

Figure 4

By total sales out of the whole data set, PS2 had the highest amount of total sales, followed by XBOX 360 and PS3. However, in the graph above that depicts the platforms of the top 100 video games, Wii is by far the leader in global sales. This may mean that the Wii had a relatively low amount of games compared to games released on PS2, but when considering the video games that made the top 100, games released on the Wii had a higher amount of sales than the games released on PS2. 

```{r genre}
vgsales %>%
  group_by(Genre) %>%
  summarise(count = n()) %>%
  arrange(desc(count))
```

Next, we look at video game releases by genre, with Action video games having the highest amount, followed by Sports, Misc, and Role-Playing. 

```{r genre-top-100}
vgsales_top_100 %>%
  group_by(Genre) %>%
  summarise(count = n()) %>%
  mutate(freq = count / sum(count)) %>%
  arrange(desc(freq))

vgsales_top_100 %>%
  group_by(Genre) %>%
  summarise(count = n()) %>%
  ggplot(aes(x = Genre, y = count)) +
  geom_col() +
  labs(title = "Video Games by Genre",
       subtitle = "Out of Top 100",
       y = "Number of Videogames") +
  coord_flip() +
  theme_light()
```

Figure 5

However, looking at the top 100 video games, we can tell that video games in the genre Shooter had the most games in the top 100, followed by platform and Role-Playing. This may mean that although the total amount of Shooter games is relatively low, those games are more popular and dominate the list of top 100 video games. This graph reflects that observation and shows the breakdown of the genres that make up the top 100 video games.

```{r genre-sales}
vgsales %>%
  filter(Year <= 2019) %>%
  group_by(Genre) %>%
  summarize(Sales = sum(Global_Sales, na.rm = TRUE)) %>%
  arrange(desc(Sales))

vgsales_top_100 %>%
  drop_na(Genre) %>%
  group_by(Genre) %>%
  mutate(Sales = sum(Global_Sales, na.rm = TRUE)) %>%
  ggplot(aes(x = Genre, y = Sales)) +
  geom_col() +
  labs(title = "Video Game Sales by Genre",
       subtitle = "Out of Top 100",
       y = "Total Global Sales (in Millions)") +
  coord_flip() +
  theme_light()
```

Figure 6

Next, we look at the total amount of sales instead of the total number of video games. From the whole data set, Action was the genre with the largest amount of sales, followed by Sports and Shooter. However, from the top 100 video games, the genre of Shooter generated the most sales, followed by Platform and Role-Playing games. 

``` {r visualize-yearly-sales-region}
vgsales_yearly <- vgsales %>%
  filter(!Year >= 2019) %>%
  group_by(Year) %>%
  summarize(Total_NA_sales = sum(NA_Sales, na.rm = TRUE), Total_EU_sales = sum(EU_Sales, na.rm = TRUE), Total_JP_sales = sum(JP_Sales, na.rm = TRUE), Total_Other_sales = sum(Other_Sales, na.rm = TRUE)) 

ggplot(vgsales_yearly, aes(x = Year, y = value, color = Region)) +
  geom_point(aes(y = Total_NA_sales, col = "North America")) +
  geom_point(aes(y = Total_EU_sales, col = "Europe")) +
  geom_point(aes(y = Total_JP_sales, col = "Japan")) +
  geom_point(aes(y = Total_Other_sales, col = "Other Regions")) +
  scale_x_discrete(breaks=seq(1970, 2025, 10)) +
  labs(title = "Distribution of Total Sales for Games Released from 1980 to 2020",
       subtitle = "By Region", 
       x = "Year",
       y = "Sales (in Millions)") +
  theme_light()
```

Figure 7

From this graph, we can see that sales by region were around the same from 1980 to 1995. However, after 1995, total sales from North American increased much more than total sales in other regions. We can also see the overall trend of sales peaking in 2010 before dropping after 2010.


### Research Question 1

```{r mutate-origin, echo = FALSE}
vgsales_origin <- vgsales %>%
  mutate(Origin = case_when(
Publisher == "10TACLE Studios" 
|Publisher == "1C Company"
|Publisher == "49Games" 
|Publisher == "505 Games"
|Publisher == "7G//AMES"
|Publisher == "Abylight"
|Publisher == "Adeline Software"
|Publisher == "Aerosoft"
|Publisher == "Alawar Entertainment"
|Publisher == "Alternative Software"
|Publisher == "Arena Entertainment"
|Publisher == "Ascaron Entertainment GmbH"
|Publisher == "Astragon"
|Publisher == "Asylum Entertainment"
|Publisher == "Avalon Interactive"
|Publisher == "Big Ben Interactive"
|Publisher == "Bigben Interactive"
|Publisher == "bitComposer Games"
|Publisher == "Black Bean Games"
|Publisher == "Blast! Entertainment Ltd"
|Publisher == "Blue Byte"
|Publisher == "Bohemia Interactive"
|Publisher == "CCP"
|Publisher == "CDV Software Entertainment"
|Publisher == "City Interactive"
|Publisher == "Codemasters"
|Publisher == "Codemasters Online"
|Publisher == "Core Design Ltd."
|Publisher == "Crimson Cow"
|Publisher == "CTO SpA"
|Publisher == "Daedalic"
|Publisher == "Daedalic Entertainment"
|Publisher == "Data Design Interactive"
|Publisher == "Deep Silver"
|Publisher == "DTP Entertainment"
|Publisher == "Easy Interactive"
|Publisher == "Eidos Interactive"
|Publisher == "Elite"
|Publisher == "Empire Interactive"
|Publisher == "Enjoy Gaming ltd."
|Publisher == "Essential Games"
|Publisher == "Evolution Games"
|Publisher == "Excalibur Publishing"
|Publisher == "Flashpoint Games"
|Publisher == "Focus Home Interactive"
|Publisher == "Focus Multimedia"
|Publisher == "Foreign Media Games"
|Publisher == "Funbox Media"
|Publisher == "Funcom"
|Publisher == "FunSoft"
|Publisher == "Funsta"
|Publisher == "Game Factory"
|Publisher == "Game Life"
|Publisher == "Gameloft"
|Publisher == "Ghostlight"
|Publisher == "GOA"
|Publisher == "Gremlin Interactive Ltd"
|Publisher == "Headup Games"
|Publisher == "Hello Games"
|Publisher == "HMH Interactive"
|Publisher == "Iceberg Interactive"
|Publisher == "Ignition Entertainment"
|Publisher == "Illusion Softworks"
|Publisher == "Infogrames"
|Publisher == "Introversion Software"
|Publisher == "ITT Family Games"
|Publisher == "Ivolgamus"
|Publisher == "Jester Interactive"
|Publisher == "JoWood Productions"
|Publisher == "Just Flight"
|Publisher == "Kalypso Media"
|Publisher == "Kando Games"
|Publisher == "Koch Media"
|Publisher == "Laguna"
|Publisher == "LEGO Media"
|Publisher == "Lexicon Entertainment"
|Publisher == "Licensed 4U"
|Publisher == "Lighthouse Interactive"
|Publisher == "Liquid Games"
|Publisher == "Magix"
|Publisher == "Mamba Games"
|Publisher == "Mastertronic"
|Publisher == "MC2 Entertainment"
|Publisher == "Microids"
|Publisher == "Midas Interactive Entertainment"
|Publisher == "Milestone S.r.l"
|Publisher == "Milestone S.r.l."
|Publisher == "Mojang"
|Publisher == "Monte Christo Multimedia"
|Publisher == "NDA Productions"
|Publisher == "Neko Entertainment"
|Publisher == "Nobilis"
|Publisher == "Nordcurrent"
|Publisher == "Nordic Games"
|Publisher == "Number None"
|Publisher == "O-Games"
|Publisher == "Ocean"
|Publisher == "Oxygen Interactive"
|Publisher == "P2 Games"
|Publisher == "Palcom"
|Publisher == "Paradox Interactive"
|Publisher == "Phenomedia"
|Publisher == "Phoenix Games"
|Publisher == "Pinnacle"
|Publisher == "Play It"
|Publisher == "Playlogic Game Factory"
|Publisher == "PlayV"
|Publisher == "Popcorn Arcade"
|Publisher == "PQube"
|Publisher == "Psygnosis"
|Publisher == "Rage Software"
|Publisher == "Rebellion"
|Publisher == "Rebellion Developments"
|Publisher == "Reef Entertainment"
|Publisher == "Revolution Software"
|Publisher == "Rising Star Games"
|Publisher == "Rondomedia"
|Publisher == "SCi"
|Publisher == "SCS Software"
|Publisher == "Slightly Mad Studios"
|Publisher == "Slitherine Software"
|Publisher == "Sold Out"
|Publisher == "Sony Computer Entertainment Europe"
|Publisher == "Sunflowers"
|Publisher == "System 3"
|Publisher == "Team17 Software"
|Publisher == "Telstar"
|Publisher == "Titus"
|Publisher == "Tivola"
|Publisher == "TopWare Interactive"
|Publisher == "U.S. Gold"
|Publisher == "Ubisoft"
|Publisher == "Ubisoft Annecy"
|Publisher == "Virgin Interactive"
|Publisher == "Wanadoo"
|Publisher == "Wargaming.net"
|Publisher == "Zoo Digital Publishing"
|Publisher == "Zushi Games" ~ "EU",
Publisher =="20th Century Fox Video Games"
|Publisher == "2D Boy" 
|Publisher == "3DO"     
|Publisher == "989 Sports"
|Publisher == "989 Studios"
|Publisher == "Acclaim Entertainment"
|Publisher == "Accolade"
|Publisher == "Ackkstudios"
|Publisher == "Activision"
|Publisher == "Activision Blizzard"
|Publisher == "Activision Value"
|Publisher == "Agetec"
|Publisher == "Aksys Games"
|Publisher == "American Softworks"
|Publisher == "Angel Studios"
|Publisher == "Answer Software"
|Publisher == "ASC Games"
|Publisher == "Aspyr"
|Publisher == "Atari"
|Publisher == "Avanquest"
|Publisher == "Avanquest Software"
|Publisher == "BAM! Entertainment"
|Publisher == "Berkeley"
|Publisher == "Bethesda Softworks"
|Publisher == "Big Fish Games"
|Publisher == "Black Label Games"
|Publisher == "BMG Interactive Entertainment"
|Publisher == "Brash Entertainment"
|Publisher == "CBS Electronics"
|Publisher == "Cloud Imperium Games Corporation"
|Publisher == "CokeM Interactive"
|Publisher == "Coleco"
|Publisher == "Conspiracy Entertainment"
|Publisher == "CPG Products"
|Publisher == "Crave Entertainment"
|Publisher == "Crystal Dynamics"
|Publisher == "Data Age"
|Publisher == "Destination Software, Inc"
|Publisher == "Destineer"
|Publisher == "Detn8 Games"
|Publisher == "Devolver Digital"
|Publisher == "Disney Interactive Studios"
|Publisher == "DreamCatcher Interactive"
|Publisher == "DreamWorks Interactive"
|Publisher == "DSI Games"
|Publisher == "Dusenberry Martin Racing"
|Publisher == "EA Games"
|Publisher == "Electronic Arts"
|Publisher == "Encore"
|Publisher == "Ertain"
|Publisher == "Evolved Games"
|Publisher == "Fox Interactive"
|Publisher == "Gamecock"
|Publisher == "GameMill Entertainment"
|Publisher == "GameTek"
|Publisher == "Gathering of Developers"
|Publisher == "Global Star"
|Publisher == "Gotham Games"
|Publisher == "Graffiti"
|Publisher == "Graphsim Entertainment"
|Publisher == "Griffin International"
|Publisher == "Groove Games"
|Publisher == "GT Interactive"
|Publisher == "Harmonix Music Systems"
|Publisher == "Hasbro Interactive"
|Publisher == "Havas Interactive"
|Publisher == "Her Interactive"
|Publisher == "Hip Interactive"
|Publisher == "id Software"
|Publisher == "Imageworks"
|Publisher == "Imagic"
|Publisher == "Insomniac Games"
|Publisher == "Interplay"
|Publisher == "Interplay Productions"
|Publisher == "inXile Entertainment"
|Publisher == "iWin"
|Publisher == "Jack of All Games"
|Publisher == "Knowledge Adventure"
|Publisher == "Kokopeli Digital Studios"
|Publisher == "Legacy Interactive"
|Publisher == "Little Orbit"
|Publisher == "LSP Games"
|Publisher == "LucasArts"
|Publisher == "Mad Catz"
|Publisher == "Majesco Entertainment"
|Publisher == "Masque Publishing"
|Publisher == "Mastiff"
|Publisher == "Mattel Interactive"
|Publisher == "Maximum Family Games"
|Publisher == "Maxis"
|Publisher == "Men-A-Vision"
|Publisher == "Mentor Interactive"
|Publisher == "Merscom LLC"
|Publisher == "Metro 3D"
|Publisher == "Microprose"
|Publisher == "Microsoft Game Studios"
|Publisher == "Midway Games"
|Publisher == "Mindscape"
|Publisher == "MLB.com"
|Publisher == "MTV Games"
|Publisher == "Mud Duck Productions"
|Publisher == "Mumbo Jumbo"
|Publisher == "Myelin Media"
|Publisher == "Mystique"
|Publisher == "Navarre Corp"
|Publisher == "NewKidCo"
|Publisher == "NovaLogic"
|Publisher == "O3 Entertainment"
|Publisher == "Origin Systems"
|Publisher == "Parker Bros."
|Publisher == "Performance Designed Products"
|Publisher == "Phantom EFX"
|Publisher == "Playmates"
|Publisher == "PopCap Games"
|Publisher == "PopTop Software"
|Publisher == "Red Orb"
|Publisher == "Red Storm Entertainment"
|Publisher == "RedOctane"
|Publisher == "responDESIGN"
|Publisher == "Scholastic Inc."
|Publisher == "Simon & Schuster Interactive"
|Publisher == "Sony Computer Entertainment America"
|Publisher == "SouthPeak Games"
|Publisher == "SPS"
|Publisher == "Square EA"
|Publisher == "SSI"
|Publisher == "Storm City Games"
|Publisher == "Strategy First"
|Publisher == "Take-Two Interactive"
|Publisher == "TalonSoft"
|Publisher == "TDK Mediactive"
|Publisher == "Telegames"
|Publisher == "Telltale Games"
|Publisher == "Tetris Online"
|Publisher == "The Adventure Company"
|Publisher == "The Learning Company"
|Publisher == "THQ"
|Publisher == "Tigervision"
|Publisher == "Time Warner Interactive"
|Publisher == "Tommo"
|Publisher == "Touchstone"
|Publisher == "Tradewest"
|Publisher == "Trion Worlds"
|Publisher == "Tripwire Interactive"
|Publisher == "UFO Interactive"
|Publisher == "Ultravision"
|Publisher == "Universal Gamex"
|Publisher == "Universal Interactive"
|Publisher == "Valcon Games"
|Publisher == "ValuSoft"
|Publisher == "Valve"
|Publisher == "Valve Software"
|Publisher == "Vir2L Studios"
|Publisher == "Virtual Play Games"
|Publisher == "Vivendi Games"
|Publisher == "Warner Bros. Interactive Entertainment"
|Publisher == "WayForward Technologies"
|Publisher == "Westwood Studios"
|Publisher == "Wizard Video Games"
|Publisher == "XS Games"
|Publisher == "Xseed Games"
|Publisher == "Yacht Club Games" ~ "NA",
Publisher == "5pb"
|Publisher == "Acquire"
|Publisher == "Agatsuma Entertainment"
|Publisher == "Alchemist"
|Publisher == "Altron"
|Publisher == "Alvion"
|Publisher ==  "AQ Interactive" 
|Publisher == "Aqua Plus"
|Publisher == "Aques" 
|Publisher ==  "Arc System Works"
|Publisher == "Aria"
|Publisher == "Arika"
|Publisher == "ArtDink"
|Publisher == "Aruze Corp"
|Publisher == "ASCII Entertainment"
|Publisher == "ASCII Media Works"
|Publisher == "Asgard"
|Publisher == "ASK"
|Publisher == "Asmik Ace Entertainment"
|Publisher == "Asmik Corp" 
|Publisher == "Athena"
|Publisher == "Atlus"
|Publisher == "Axela"
|Publisher == "Banpresto"
|Publisher == "Benesse"
|Publisher == "Bomb"
|Publisher == "BPS"
|Publisher == "Broccoli"
|Publisher == "BushiRoad"
|Publisher == "Capcom"
|Publisher == "Cave"
|Publisher == "ChunSoft"
|Publisher == "Coconuts Japan"
|Publisher == "Comfort"
|Publisher == "Compile"
|Publisher == "Compile Heart"
|Publisher == "Creative Core"
|Publisher == "Culture Brain"
|Publisher == "Culture Publishers"
|Publisher == "CyberFront"
|Publisher == "Cygames"
|Publisher == "D3Publisher"
|Publisher == "Daito"
|Publisher == "Data East"
|Publisher == "Datam Polystar"
|Publisher == "DHM Interactive"
|Publisher == "DigiCube"
|Publisher == "Dorart"
|Publisher == "dramatic create"
|Publisher == "Ecole"
|Publisher == "Edia"
|Publisher == "Electronic Arts Victor"
|Publisher == "Elf"
|Publisher == "Enix Corporation"
|Publisher == "Enterbrain"
|Publisher == "Epoch"
|Publisher == "ESP"
|Publisher == "Experience Inc."
|Publisher == "Extreme Entertainment Group"
|Publisher == "Falcom Corporation"
|Publisher == "Fields"
|Publisher == "Flight-Plan"
|Publisher == "fonfun"
|Publisher == "Fortyfive"
|Publisher == "From Software"
|Publisher == "Fuji"
|Publisher == "FuRyu"
|Publisher == "FuRyu Corporation"
|Publisher == "G.Rev"
|Publisher == "Gaga"
|Publisher == "Gainax Network Systems"
|Publisher == "Gakken"
|Publisher == "Game Arts"
|Publisher == "Gamebridge"
|Publisher == "General Entertainment"
|Publisher == "Genki"
|Publisher == "Giga"
|Publisher == "Giza10"
|Publisher == "Glams"
|Publisher == "Global A Entertainment"
|Publisher == "GN Software"
|Publisher == "Grand Prix Games"
|Publisher == "GungHo"
|Publisher == "Gust"
|Publisher == "Hackberry"
|Publisher == "HAL Laboratory"
|Publisher == "Hamster Corporation"
|Publisher == "Happinet"
|Publisher == "Hearty Robin"
|Publisher == "Hect"
|Publisher == "Hudson Entertainment"
|Publisher == "Hudson Soft"
|Publisher == "Human Entertainment"
|Publisher == "HuneX"
|Publisher == "Idea Factory"
|Publisher == "IE Institute"
|Publisher == "Imadio"
|Publisher == "Image Epoch"
|Publisher == "imageepoch Inc."
|Publisher == "Imagineer"
|Publisher == "Imax"
|Publisher == "Interchannel"
|Publisher == "Intergrow"
|Publisher == "Irem Software Engineering"
|Publisher == "Jaleco"
|Publisher == "Jorudan"
|Publisher == "JVC"
|Publisher == "Kadokawa Games"
|Publisher == "Kadokawa Shoten"
|Publisher == "Kaga Create"
|Publisher == "Kamui"
|Publisher == "Karin Entertainment"
|Publisher == "Kemco"
|Publisher == "KID"
|Publisher == "Kids Station"
|Publisher == "King Records"
|Publisher == "Konami Digital Entertainment"
|Publisher == "Kool Kizz"
|Publisher == "KSS"
|Publisher == "Level 5"
|Publisher == "Locus"
|Publisher == "Magical Company"
|Publisher == "Marvel Entertainment"
|Publisher == "Marvelous Entertainment"
|Publisher == "Marvelous Games"
|Publisher == "Marvelous Interactive"
|Publisher == "Max Five"
|Publisher == "Media Factory"
|Publisher == "Media Rings"
|Publisher == "Media Works"
|Publisher == "MediaQuest"
|Publisher == "Micro Cabin"
|Publisher == "Milestone"
|Publisher == "Minato Station"
|Publisher == "Mirai Shounen"
|Publisher == "Misawa"
|Publisher == "Mitsui"
|Publisher == "mixi, Inc"
|Publisher == "Moss"
|Publisher == "MTO"
|Publisher == "Mycom"
|Publisher == "Namco Bandai Games"
|Publisher == "Natsume"
|Publisher == "NCS"
|Publisher == "NEC"
|Publisher == "NEC Interchannel"
|Publisher == "NetRevo"
|Publisher == "New"
|Publisher == "Nichibutsu"
|Publisher == "Nihon Falcom Corporation"
|Publisher == "Nintendo"
|Publisher == "Nippon Amuse"
|Publisher == "Nippon Columbia"
|Publisher == "Nippon Ichi Software"
|Publisher == "Nippon Telenet"
|Publisher == "Office Create"
|Publisher == "On Demand"
|Publisher == "Pacific Century Cyber Works"
|Publisher == "Pack In Soft"
|Publisher == "Pack-In-Video"
|Publisher == "Panther Software"
|Publisher == "Paon"
|Publisher == "Paon Corporation"
|Publisher == "Pioneer LDC"
|Publisher == "Playmore"
|Publisher == "Plenty"
|Publisher == "Pony Canyon"
|Publisher == "Pow"
|Publisher == "Princess Soft"
|Publisher == "Prototype"
|Publisher == "Quest"
|Publisher == "Quinrose"
|Publisher == "Quintet"
|Publisher == "RED Entertainment"
|Publisher == "Revolution (Japan)"
|Publisher == "Riverhillsoft"
|Publisher == "Rocket Company"
|Publisher == "Sammy Corporation"
|Publisher == "Saurus"
|Publisher == "Screenlife"
|Publisher == "Sega"
|Publisher == "Seta Corporation"
|Publisher == "Seventh Chord"
|Publisher == "Shogakukan"
|Publisher == "SNK"
|Publisher == "SNK Playmore"
|Publisher == "Societa"
|Publisher == "Sonnet"
|Publisher == "Sony Computer Entertainment"
|Publisher == "Sony Music Entertainment"
|Publisher == "Sony Online Entertainment"
|Publisher == "Spike"
|Publisher == "Square"
|Publisher == "Square Enix"
|Publisher == "SquareSoft"
|Publisher == "Starfish"
|Publisher == "Sting"
|Publisher == "Success"
|Publisher == "Sunrise Interactive"
|Publisher == "Sunsoft"
|Publisher == "Sweets"
|Publisher == "System Soft"
|Publisher == "T&E Soft"
|Publisher == "Taito"
|Publisher == "Takara"
|Publisher == "Takara Tomy"
|Publisher == "Technos Japan Corporation"
|Publisher == "TechnoSoft"
|Publisher == "Tecmo Koei"
|Publisher == "TGL"
|Publisher == "TOHO"
|Publisher == "Tomy Corporation"
|Publisher == "Tryfirst"
|Publisher == "TYO"
|Publisher == "Type-Moon"
|Publisher == "UEP Systems"
|Publisher == "Vap"
|Publisher == "Vic Tokai"
|Publisher == "Victor Interactive"
|Publisher == "Video System"
|Publisher == "Views"
|Publisher == "Visco"
|Publisher == "Warashi"
|Publisher == "Warp"
|Publisher == "Xing Entertainment"
|Publisher == "Yamasa Entertainment"
|Publisher == "Yeti"
|Publisher == "Yuke's"
|Publisher == "Yumedia"
|Publisher == "Zenrin" ~ "JP",
Publisher == "Home Entertainment Suppliers"
|Publisher == "Idea Factory International"
|Publisher == "Indie Games"
|Publisher == "GSP"
|Publisher == "Mercury Games"
|Publisher == "N/A"
|Publisher == "NCSoft"
|Publisher == "Nexon"
|Publisher == "Phantagram"
|Publisher == "PM Studios"
|Publisher == "Quelle"
|Publisher == "RTL"
|Publisher == "Russel"
|Publisher == "Sears"
|Publisher == "Starpath Corp."
|Publisher == "Summitsoft"
|Publisher == "Swing! Entertainment"
|Publisher == "Syscom"
|Publisher == "System 3 Arcade Software"
|Publisher == "TDK Core"
|Publisher == "Tru Blu Entertainment"
|Publisher == "Unknown"
|Publisher == "Vatical Entertainment"
|Publisher == "White Park Bay Software"
|Publisher == "Xicat Interactive"
|Publisher == "Xplosiv"
|Publisher == "Zoo Games" 
|Publisher == "NA" ~ "Other"
))
```

```{r add-platform,echo=FALSE}
vgsales_origin <- vgsales_origin %>%
  mutate(plat_origin = case_when(
Platform == "2600"
|Platform == "3DO"
|Platform == "DS"
|Platform == "PC"
|Platform == "WiiU"
|Platform == "XB" ~ "NA",
Platform == "3DS"
|Platform == "DC"
|Platform == "GB"
|Platform == "GBA"
|Platform == "GC"
|Platform == "GEN"
|Platform == "GG"
|Platform == "N64"
|Platform == "NES"
|Platform == "NG"
|Platform == "PCFX"
|Platform == "PS"
|Platform == "PS2"
|Platform == "PS3"
|Platform == "PS4"
|Platform == "PSP"
|Platform == "PSV"
|Platform == "SAT"
|Platform == "SCD"
|Platform == "SNES"
|Platform == "TG16"
|Platform == "WS" ~ "JP",
Platform == "Wii"
|Platform == "X360"
|Platform == "XOne"
|Platform == "NA" ~ "Other"
))

```


```{r publisher-lm}
(tidy(lm_NApub <- lm(NA_Sales ~ Origin + plat_origin,
                     data = vgsales_origin)) %>%
  select(term, estimate))

(tidy(lm_EUpub <- lm(EU_Sales ~ Origin + plat_origin,
                     data = vgsales_origin)) %>%
  select(term, estimate))

(tidy(lm_JPpub <- lm(JP_Sales ~ Origin + plat_origin,
                     data = vgsales_origin)) %>%
  select(term, estimate))
```

From the coefficients in the linear model, North American video game sales appear to be slightly positively affected by whether the publisher of the game is from either Japan or North America, moreso for the latter. The sales seem to be slightly negatively affected if the game's platform is was released first in North America, and positively affected if the game's platform was released first in a location outside of Europe, North America, and Japan.

European video game sales appear to have the same positive and negative trends as with North American sales, albeit with different magnitudes of intercepts.

Japanese video game sales appear to be positively affected when the game's publisher is from Japan and negatively affected is the game's publisher is from North America. Additionally, the sales seem to be negatively affected if the game's platform was released first in North America or in a location outside of Europe, North America, and Japan.

### Research Question 2

Our next bit of analysis centers around our second research question of whether or not a games release year affects the sales it receives. In Figure 7 we created a dot plot depicting the total sales achieved by games in each release year by region, but we wanted to explore this concept a little deeper. Since our data set maps the amount of global sales a video game recieves to success, we wanted to know if a games release year had any affect on its global sales. We decided to explore this by conducting a permutation hypothesis test to infer independence between a games release year and global sales it receives.

```{r centurygame}
vgsales <- vgsales %>%
  filter(Year != "N/A") %>%
  mutate(centurygame = case_when(Year > 1999 ~ "21st",
                                 Year > 1900 | Year <= 1999 ~ "20th"))
```

To begin, we filtered our data set for unavailable years and used the case_when function to mutate a new *centurygame* variable, which represents the century in which a video game was released (all games released before 1999 are 20th century games and all games released after 1999 are 21st century games).  This was done to allow us to separate our data into two groups to be tested, as well as to make a broader conclusion as to whether older or newer games achieved higher median sales. 

```{r relevant-summary-stat, warning=FALSE}
ggplot(data = vgsales, mapping = aes(x = Global_Sales))+
  geom_histogram(binwidth = 1)+
  labs(x = "Global Sales", y = "Count", title = "Global Sales Histogram") +
  theme_light()
```

After this, we created a histogram to see which summary statistic (between mean and median) would be most relevant in inferring independence between a game's release year and the amount of global sales it receives.  From our histogram we can see that the data is overall highly skewed right, meaning that our median would be a safer option in comparison to our mean.

```{r random-sample}
set.seed(29847)

vgsales_random_1000 <- sample_n(vgsales, 1000, replace = FALSE)

ggplot(data = vgsales_random_1000, mapping = aes(x = Global_Sales))+
  geom_histogram(binwidth = 1)+
  labs(x = "Global Sales", y = "Count", title = "Global Sales Sample Histogram") +
  theme_light()
```

We then decided to generate a random sample without replacement of 1000 videogames to represent our sample population. We chose a size of 1000 because it was less than 10% of our actual population, which follows the guidelines of the central limit theorem's condition for inferring independence. We then created a histogram to see if our sample data was accurately representative of our original data set.  Since both histograms looked relatively similar, we decided to proceed with our sample.  

We were then ready to generate our two hypotheses to be tested, which are as follows:

H0: Our null hypothesis is that the difference in our median global sales between 20th and 21st century games is zero (meaning that year of release and global sales are independent).

HA: Our alternative hypothesis is that there is a non-zero difference in the median global sales of 20th and 21st century games (meaning that year of release and global sales are dependent).

We then began conducting our hypothesis test below:

```{r observed-median-difference}
diff_med <- vgsales_random_1000 %>%
  specify(response = Global_Sales, explanatory = centurygame) %>%
  calculate("diff in medians", order = c("20th", "21st"))

diff_med
```  

First we coded to find the observed median difference between 20th and 21st century games.  The observed difference in medians (in order of 20th century - 21st century) was `r diff_med`.

```{r hypothesis-test}
set.seed(29847)
median_diff_null_dist <- vgsales_random_1000 %>%
  specify(response = Global_Sales, explanatory = centurygame) %>%
  hypothesize(null = "independence") %>%
  generate(reps = 1000, type = "permute") %>%
  calculate(stat = "diff in medians", order = c("20th", "21st"))

visualize(median_diff_null_dist)+
  labs(title = "Null Distribution of Difference in Median Global Sales", subtitle = "Between 20th and 21st Century Games", x = "Generated Stats", y = "Count") +
  theme_light()

get_p_value(median_diff_null_dist, obs_stat = diff_med, direction = "both")
```

Above we conducted a hypothesis test by generating a permutation of 1000 reps calculating for the difference in medians to create a null distribution.  This is visualized above.  We then calculated a two-tailed p-value represented as the proportion of our calculated differences that were more extreme than our observed difference both in the negative and positive directions. Our calculated p-value was `r get_p_value(median_diff_null_dist, obs_stat = diff_med, direction = "both")` which is less than our alpha value of .05, allowing us to reject the null hypothesis in favor of our alternative hypothesis.  This means that our data provides convincing evidence that there is a statistically significant non-zero difference between the median global sales of 20th and 21st century games, suggesting dependence between a game's release year and the amount of global sales it receives.

```{r confidence-interval}
set.seed(29847)
vgsales_random_boot_dist <- vgsales_random_1000 %>%
  specify(response = Global_Sales, explanatory = centurygame) %>%
  generate(reps = 1000, type = "bootstrap") %>%
  calculate(stat = "diff in medians", order = c("20th", "21st"))

(percent_ci <- get_ci(vgsales_random_boot_dist, level = .95))

visualize(vgsales_random_boot_dist)+
  shade_ci(endpoints = percent_ci) +
  theme_light() +
  labs(title = "Bootstrap Distribution of Difference in Medians",
       subtitle = "Between 20th and 21st Century Games",
       x = "Difference in Medians",
       y = "Count")
```

Since we can infer statistical significance from our data, we decided to calculate a 95% confidence interval to estimate what our difference in global sales between 20th and 21st century games would be. This was calculated above and visualized above.  From our confidence interval, we can say that we are 95% confident that the difference in median globals sales of 20th and 21st century games lies somewhere between the interval of `r vgsales_random_1000 %>% specify(response = Global_Sales, explanatory = centurygame) %>% generate(reps = 1000, type = "bootstrap") %>% calculate(stat = "diff in medians", order = c("20th", "21st")) %>% summarize(lower_bound = quantile(stat, .025))` and `r vgsales_random_1000 %>% specify(response = Global_Sales, explanatory = centurygame) %>% generate(reps = 1000, type = "bootstrap") %>% calculate(stat = "diff in medians", order = c("20th", "21st")) %>% summarize(lower_bound = quantile(stat, .975))`.  Given that our order is 20th - 21st century, and that our confidence interval lies on the positive end of the spectrum, we can conclude that 20th century games are expected to have a higher amount of global sales in comparison to 21st century games.  This makes sense in the context of our data, as 20th century games have been around for a longer period of time, allowing to accumulate higher global sales.   

Once we were better able to see as to whether or not a games release year affected a game's global sales, we decided to look deeper into how each country specifically views the various criteria for video games, i.e. if certain criteria affect the total sales in one country more so than in others.  To show this, we decided to create linear models of total sales based on video game criteria (genre, publisher, platform, and centurygame) for each country.

In our preliminary creation of our linear models, we began to notice that since each criteria was categorical, we were going to have an unreasonable amount of dummy variables to analyze in our linear models.  Because of this, we decided to narrow down each of the criteria into their top three forms based on the total amount of global sales each form received. 

```{r top-three}
vgsales %>%
  filter(Year <= 2019) %>%
  group_by(Publisher) %>%
  summarize(Sales = sum(Global_Sales, na.rm = TRUE)) %>%
  arrange(desc(Sales)) %>%
  head(3)

vgsales %>%
  filter(Year <= 2019) %>%
  group_by(Platform) %>%
  summarize(Sales = sum(Global_Sales, na.rm = TRUE)) %>%
  arrange(desc(Sales)) %>%
  head(3)

vgsales %>%
  filter(Year <= 2019) %>%
  group_by(Genre) %>%
  summarize(Sales = sum(Global_Sales, na.rm = TRUE)) %>%
  arrange(desc(Sales)) %>%
  head(3)
```

From our code above we can see that the top three publishers were Nintendo, Electronic Arts, and Activision, our top three platforms were PS2, X360, and PS3, and our top three Genres were Action, Sports, and Shooter.

From here we mutated our three criteria in our random sample dataset to be labeled as their most popular version if they are as such, and “other” if they are not.

```{r top-criteria}
vgsales_top <- vgsales_random_1000 %>%
  mutate(Publisher = case_when(Publisher == "Nintendo" ~ "Nintendo",
                               Publisher == "Electronic Arts" ~ "Electronic Arts",
                                Publisher == "Activision" ~ "Activision",
                               TRUE ~ "Other"),
         Publisher = fct_relevel(Publisher, "Other"),
         Platform = case_when(Platform == "PS2" ~ "PS2",
                              Platform == "X360" ~ "X360",
                              Platform == "PS3" ~ "PS3", 
                              TRUE ~ "Other"),
         Platform = fct_relevel(Platform, "Other"),
         Genre =  case_when(Genre == "Action" ~ "Action",
                            Genre == "Sports" ~ "Sports",
                            Genre == "Shooter" ~ "Shooter",
                            TRUE ~ "Other"),
         Genre = fct_relevel(Genre, "Other"))
```

Once this was done, we began creating our linear models for each country:

```{r linear-models}
(tidy(lm_NA <- lm(NA_Sales ~ Publisher + centurygame + Genre + Platform +
                         Genre*Platform, data = vgsales_top)) %>%
  select(term, estimate))

(tidy(lm_EU <- lm(EU_Sales ~ Publisher + centurygame + Genre + Platform +
                         Genre*Platform, data = vgsales_top)) %>%
  select(term, estimate))

(tidy(lm_JP <- lm(JP_Sales ~ Publisher + centurygame + Genre + Platform +
                         Genre*Platform, data = vgsales_top)) %>%
  select(term, estimate))
```

Once our linear models had been created, we decided to use backwards selection based on AIC to see which of our predictors were the most important when it comes to their effect on sales by country.

```{r backward-selection-AIC}
(tidy(model_sel_NA <- step(lm_NA, direction = "backward",
                                trace = FALSE)) %>%
  select(term, estimate))

(tidy(model_sel_EU <- step(lm_EU, direction = "backward",
                                trace = FALSE)) %>%
  select(term, estimate))

(tidy(model_sel_JP <- step(lm_JP, direction = "backward",
                                trace = FALSE)) %>%
  select(term, estimate))
```

After performing our backwards selection, we can see that in North America all criteria seemed to be viewed as important, in Europe all but the century in which the game was released are viewed as important, and in Japan all but the genre (and simultaneously all interactions between genre and platform) of the video game are viewed as important.   

Even after our backwards selection for our models, we were still left with very many variables to interpret, so we decided to focus on those variables whose p-values were statistically significant depending on its relationship to our alpha value of .05.

```{r print-p_values}
tidy(model_sel_JP) %>%
  select(term, estimate, p.value)

tidy(model_sel_EU) %>%
  select(term, estimate, p.value)

tidy(model_sel_NA) %>%
  select(term, estimate, p.value)
```

From our printed p-values above, we can see that although some variables were left in our selected models, they lacked statistical significance (meaning that they had very large p-values).  This was the case for example with our *Genre* variables, which again were thrown out completely in the linear model for Japan, and whose p-values are very high in our linear models for both North America and Europe.

Interestingly enough the most statistically significant predictors across each country seems to be the *PublisherNintendo* variable, with the slope of this variable in Japan, Europe, and North America being `r tidy(model_sel_JP) %>% filter(term == "PublisherNintendo") %>% select(estimate)`, `r tidy(model_sel_EU) %>% filter(term == "PublisherNintendo") %>% select(estimate)`, and `r tidy(model_sel_NA) %>% filter(term == "PublisherNintendo") %>% select(estimate)` respectively.

The interpretation of these slopes are as follows:

In North America, the slope of the *PublisherNintendo* variable can be interpreted as, holding all else constant, the slope of the linear regression line would be the same but with an expected intercept increase of `r tidy(model_sel_NA) %>% filter(term == "PublisherNintendo") %>% select(estimate)`.  This means that on average, if a games publisher is Nintendo, we can expect its overall sales in North America to be increased by a value of `r tidy(model_sel_NA) %>% filter(term == "PublisherNintendo") %>% select(estimate)`.

In Europe, the slope of the *PublisherNintendo* variable can be interpreted as, holding all else constant, the slope of the linear regression line would be the same but with an expected intercept increase of `r tidy(model_sel_EU) %>% filter(term == "PublisherNintendo") %>% select(estimate)`.  This means that on average, if a games publisher is Nintendo, we can expect its overall sales in Europe to be increased by a value of `r tidy(model_sel_EU) %>% filter(term == "PublisherNintendo") %>% select(estimate)`.

In Japan, the slope of the *PublisherNintendo* variable can be interpreted as, holding all else constant, the slope of the linear regression line would be the same but with an expected intercept increase of `r tidy(model_sel_JP) %>% filter(term == "PublisherNintendo") %>% select(estimate)`.  This means that on average, if a games publisher is Nintendo, we can expect its overall sales in Japan to be increased by a value of `r tidy(model_sel_JP) %>% filter(term == "PublisherNintendo") %>% select(estimate)`.

That being said, there were a few differences across each country when it came to what variables were deemed statistically significant.  Take for example the *PlatformPS3* variable, which is deemed statistically significant in both Europe and North America, but not so in Japan.

In North America, the slope of the *PlatformPS3* variable can be interpreted as, holding all else constant, the slope of the linear regression line would be the same but with an expected intercept increase of `r tidy(model_sel_NA) %>% filter(term == "PlatformPS3") %>% select(estimate)`.  This means that on average, if a games platform is PS3, we can expect its overall sales in North America to be increased by a value of `r tidy(model_sel_NA) %>% filter(term == "PlatformPS3") %>% select(estimate)`.

In Europe, the slope of the *PlatformPS3* variable can be interpreted as, holding all else constant, the slope of the linear regression line would be the same but with an expected intercept increase of `r tidy(model_sel_EU) %>% filter(term == "PlatformPS3") %>% select(estimate)`.  This means that on average, if a games platform is PS3, we can expect its overall sales in Europe to be increased by a value of `r tidy(model_sel_EU) %>% filter(term == "PlatformPS3") %>% select(estimate)`.

As for the *centurygame21st* variable, Europe did not deem it as statistically significant, as it was thrown out during backward selection of its linear model.  However, *centurygame21st* was statistically significant in both Japan and North America, with p-values lower than our alpha value of .05 (although just barely in North America).

In Japan, the slope of the *centurygame21st* variable can be interpreted as, holding all else constant, the slope of the linear regression line would be the same but with an expected intercept decrease of `r (tidy(model_sel_JP) %>% filter(term == "centurygame21st") %>% select(estimate)) * -1` (this is because the value associated with this slope is negative).  This means that on average, if a was released in the 21st century, we can expect its overall sales in Japan to be decreased by a value of `r (tidy(model_sel_JP) %>% filter(term == "centurygame21st") %>% select(estimate)) * -1` vs if it were released in the 20th century.

In North America, the slope of the *centurygame21st* variable can be interpreted as, holding all else constant, the slope of the linear regression line would be the same but with an expected intercept decrease of `r (tidy(model_sel_NA) %>% filter(term == "centurygame21st") %>% select(estimate)) * -1` (this is because the value associated with this slope is negative).  This means that on average, if a was released in the 21st century, we can expect its overall sales in North America to be decreased by a value of `r (tidy(model_sel_NA) %>% filter(term == "centurygame21st") %>% select(estimate)) * -1` vs if it were released in the 20th century.

This actually lines up with the findings from our hypothesis test conducted earlier, showing how 20th century games are estimated to have higher global sales than 21st century games.

```{r r-squared-value}
glance(model_sel_JP)$r.squared
glance(model_sel_NA)$r.squared
glance(model_sel_EU)$r.squared
```

We produced the r-squared values from our selected linear models above, and they are interpreted as follows:

With an r-squared value of `r glance(model_sel_JP)$r.squared`, we can say that roughly 27.2% of the variability in Japanese sales can be explained by the top three platforms and publishers, as well as the century in which the game was released.

With an r-squared value of `r glance(model_sel_NA)$r.squared`, we can say that roughly 15.2% of the variability in North American sales can be explained by the top three platforms, genres, and publishers, as well as the century in which the game was released.

With an r-squared value of `r glance(model_sel_EU)$r.squared`, we can say that roughly 11.3% of the variability in European sales can be explained by the top three platforms, genres, and publishers of the game.

Unfortunately, given these results our linear models we created did not really have relatively strong fits for our data set. We decided to test this further by visualizing residual plots for our linear models.  We augmented these models so as to give us a tidy regression output.

```{r residual-plots}
model_sel_JP_aug <- augment(model_sel_JP)
model_sel_NA_aug <- augment(model_sel_NA)
model_sel_EU_aug <- augment(model_sel_EU)

ggplot(model_sel_JP_aug, mapping = aes(x = .fitted, y = .resid)) +
  geom_point(alpha = 0.5) +
  geom_hline(yintercept = 0, color = "blue", lty = 2) +
  labs(x = "Predicted Japan Sales", y = "Residuals", 
       title = "Residuals for Japan Linear Model") +
  theme_light()

ggplot(model_sel_NA_aug, mapping = aes(x = .fitted, y = .resid)) +
  geom_point(alpha = 0.5) +
  geom_hline(yintercept = 0, color = "blue", lty = 2) +
  labs(x = "Predicted North America Sales", y = "Residuals",
       title = "Residuals for North America Linear Model") +
  theme_light()

ggplot(model_sel_EU_aug, mapping = aes(x = .fitted, y = .resid)) +
  geom_point(alpha = 0.5) +
  geom_hline(yintercept = 0, color = "blue", lty = 2) +
  labs(x = "Predicted Europe Sales", y = "Residuals",
       title = "Residuals for Europe Linear Model") +
  theme_light()
```

From our visualized residual plots above, we can see that for each model, it seems as though the higher the predicted sales in each country gets, the less fit our linear model becomes. The residuals on the lower endpoints of our graph are not far off from our augmented linear model, but as the predicted sales value increases, the residuals stray further and further from the line.

### Limitations

One of the primary limitations for this analysis is that sales are cumulative to present day. This means that popular games released in the previous year or two have not had much time to attain more sales, unlike games released 5 or 6 years ago which have had a lot more time to attain more sales. This skews the data on sales, as games released 4-5 years ago may seem more popular than games released 1-2 years ago, when that may not be the actual case given the time frame for the recorded sales. 

In addition, there is no data on the combination of games between certain platforms. For example, games released on multiple platforms are listed as seperate games due to the differing platforms. A certain game may have been released on both the PS3 and XBOX 360 and qualifies as two separate observations in the data set when they really should be one, with the figures for sales combined between them. This makes it harder to analyze the popularity of games or attributes of games, as a shooter game might qualify as two observations in the top 100 when it should be one, therefore skewing the data. However, this does allow for further analysis on platforms, as the popularity in terms of total sales can be separated into different platforms. 

Finally, when generating linear models, there were variables with more than 10-20 categories. This almost makes it impossible to describe the correct coefficients for each category due to the sheer amount of categories in variables such as platform, genre, and publisher. We had to narrow down these variables into the top 3 categories by sales for each variable, along with "other", to make our model more streamlined. This does sacrifice some specificity for the linear model due to less variables, but makes the model easier to read and more focused on the top performing categories.

### Conclusion

We started off this project with two research questions that we believed to be interesting and answerable using inference methods in our data analysis. After further analysis, our results and conclusions will be described below. 

	In the data analysis for our first research question, we explored how having a platform or publisher originate from your own region affect the sales of those games in that given region. We had to mutate a new variable called “origin” that would include the origin of region for the publisher of the game, in addition to a new variable called “plat_origin” that included the origin of the platform for the game. We performed this using a linear regression, creating linear regression models for each region and determining if the publisher origin or the platform origin had any influence on sales, as determined by the coefficient. For instance, the model for Japanese sales had a fairly high coefficient if the publisher was from Japan, meaning that publishers in Japan had higher success in Japan compared to other publishers. The same can be said for the North American model. However, in Europe, the model did not show much difference between the baseline (publisher from Europe), as the coefficients for publishers from North America or Japan were relatively small. Since we had to manually enter the region for each publisher and platform, it is clear that this may pose a problem if this project were to be replicated. It was tedious to enter the region for each publisher and platform. 
	
In the data analysis for our second research question, we explored the various qualities of video games and the impact that they made on a game’s overall global and region-specific sales.  These qualities included Publisher, Genre, Platform, and the games release year.  We performed this via hypothesis test and analysis of linear regression models.  We began by asking the question as to whether or not the year a given game was released in had any effect on the amount of global sales it receives.  Our approach to answering this was to conduct a permutation hypothesis test to infer independence between a games release year and global sales it receives.  Since there were so many release years in our data set, we decided to generalize them into two categories: 20th and 21st century games.  Labeled centurygame, we used this as our explanatory variable by which we separated  our data sets.  Once this was done we were able to formulate our two hypotheses.  Our null hypothesis was that the difference in our median global sales between 20th and 21st century games is zero (meaning that year of release and global sales are independent), while our alternative hypothesis was that there is a non-zero difference in the median global sales of 20th and 21st century games (meaning that year of release and global sales are dependent).  We used a random sample of size 1000 (without replacement; in compliance with the central limit theorems guidelines for inferring independence) to conduct our hypothesis test and were given a p-value less than our alpha of .05.  This means that we were able to reject the null hypothesis in favor of the alternative, meaning that our data provides convincing evidence that there is a statistically significant non-zero difference between the median global sales of 20th and 21st century games, suggesting dependence between a game's release year and the amount of global sales it receives.  We then developed a 95% confidence interval showing that our difference would always be in a positive range, meaning that it is expected for 20th century games to make higher global sales than 21st century games.  
These findings were further solidified upon fitting linear models which mapped the dependence of region specific sales to all of the qualities of a video game  (genre, publisher, platform, and centurygame).  In our preliminary creation of our linear models, we began to notice that since each quality was categorical, we were going to have an unreasonable amount of dummy variables to analyze in our linear models.  Because of this, we decided to narrow down each of the criteria into their top three forms based on the total amount of global sales each form received (excluding centurygame, as it only had two categories).  We then created our three linear models (one for Japan, one for North America, and one for Europe) and used backwards selection to determine which variables had the most effect on the region specific sales.  After performing our backwards selection, we saw that in North America all criteria seemed to be viewed as important, in Europe all but the century in which the game was released are viewed as important, and in Japan all but the genre (and simultaneously all interactions between genre and platform) of the video games are viewed as important.  We also found that a game being released in the 21st century had negative effects on the slopes of our linear models, indicating that 20th century games were more favorable.  Once we finished this we decided to create residual plots to determine how fit our models were to the data, but they unfortunately did not fit well (this was also evident from our r.squared values).  Some critiques to our methods would include our decision to separate the game’s release year into two categories, largely generalizing the results of our hypothesis test in relation to our initial question of how much a games release year affected the global sales it receives.  Yet another critique would be our decision to narrow our qualities into their top three groups of each kind, which again largely generalizes our results in the context of our actual population size. 

When we started the project, we tried to tackle two big research questions that had many components to them. This only allowed us to answer the questions at a surface level and prevented us from being able to dig deep into the analyses and conclusions. We were only able to answer according to certain components of these broad questions, leaving other important components out of our analyses. Additionally, the questions were not able to be correctly answered using the inference methods we chose. By the time we got to the writeup, it was more clear to us what research questions we needed to answer and what components we could/could not analyze. 

If we were able to start over with the project, we would have chosen to answer the more distinct research questions that we chose instead of spending time on the broader ones with many moving components. We would have also paid more attention to making visuals, because at the end of the project we realized how helpful they were in helping others understand the analysis that we performed. If we were to continue with this project, it would be interesting to see how video games have changed in terms of the popularity of genres, publishers, and platforms across different countries from this decade and the last, since we are coming up on the end of the decade. We could also try to make predictions and extend upon our analysis we performed, predicting what we think the popularity of video games will look like for the decade to come. Additionally, it would be interesting to see if the action/shooter genre is the most popular in the U.S., due to the controversial topic of videogame violence and aggression that has swept the U.S. over the years.